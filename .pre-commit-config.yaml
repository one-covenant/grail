# Pre-commit hooks using uv run to ensure version consistency with CI
# Install: pre-commit install
# Run manually: pre-commit run --all-files
#
# All Python tools (ruff, pyright) use uv run to match exact versions in uv.lock
# This ensures local pre-commit checks match CI exactly.

repos:
  # Local hooks using uv run - matches CI exactly
  - repo: local
    hooks:
      - id: ruff-check
        name: ruff (lint)
        entry: uv run ruff check --fix
        language: system
        types: [python]
        require_serial: true
        exclude: ^(scripts/|research/)

      - id: ruff-format
        name: ruff (format)
        entry: uv run ruff format
        language: system
        types: [python]
        require_serial: true
        exclude: ^(scripts/|research/)

      - id: pyright
        name: pyright (typecheck)
        entry: uv run pyright grail
        language: system
        types: [python]
        pass_filenames: false
        require_serial: true

  # Basic file quality checks (version-insensitive, safe to use from remote)
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.5.0
    hooks:
      - id: trailing-whitespace
        name: trim trailing whitespace
      - id: end-of-file-fixer
        name: fix end of files
      - id: check-yaml
        name: check yaml syntax
      - id: check-toml
        name: check toml syntax
      - id: check-added-large-files
        args: [--maxkb=1000]
        name: check for large files
      - id: detect-private-key
        name: detect private keys
      - id: check-merge-conflict
        name: check for merge conflicts
